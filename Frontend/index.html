<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <title>Formulario</title>
  </head>
  <body>
    <script type="module" src="./src/main.js"></script>
    <script>
      document
        .getElementById("loginForm")
        .addEventListener("submit", async function (event) {
          event.preventDefault();

          const username = document.getElementById("name").value;
          const password = document.getElementById("password").value;

          // Validaci칩n b치sica
          if (!username || !password) {
            document.getElementById("message").innerText =
              "Por favor, completa todos los campos.";
            return;
          }

          try {
            const response = await fetch("http://localhost:3000/login", {
              method: "POST",
              credentials: "include", // Importante para enviar las cookies de sesi칩n
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({ username, password }),
            });

            if (!response.ok) {
              divError.innerText = "Credenciales inv치lidas";
              divError.classList.add(
                "bg-danger",
                "text-white",
                "text-center",
                "rounded",
                "p-2",
                "mt-3"
              );

              setTimeout(() => {
                divError.hidden = true;
              }, 3500);

              return;
            }

            const data = await response.json();
            console.log(data);
            window.location.href = "home.html";
          } catch (error) {}
        });
    </script>
  </body>
</html>
